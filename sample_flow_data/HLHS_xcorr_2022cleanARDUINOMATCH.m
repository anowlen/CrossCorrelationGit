close all
clearvars
clc

%T = readtable('0.1mL-min#2.csv');
%T = readtable('SampleData10-21-2.csv');
T = readtable('SampleData10-21-4.csv');


res = 0.01; %resolution in seconds (1/Hz)
%res = .005; %sample every 5 ms

dz1 = T(:,1);
dz2 = T(:,2);

line1 = table2array(dz1(2895:4894,:));
line2 = table2array(dz2(2895:4894,:));

line1 = [2.145697,
2.145743,
2.145817,
2.145907,
2.146001,
2.146084,
2.146143,
2.146167,
2.146152,
2.146107,
2.146035,
2.145953,
2.145876,
2.145821,
2.145799,
2.145814,
2.145869,
2.14596,
2.146074,
2.146197,
2.146316,
2.146413,
2.146477,
2.146501,
2.146482,
2.146422,
2.146329,
2.146216,
2.146098,
2.14599,
2.145903,
2.145852,
2.145841,
2.145869,
2.145938,
2.146039,
2.14616,
2.146289,
2.146417,
2.14653,
2.146616,
2.146666,
2.146676,
2.146643,
2.146565,
2.14645,
2.146303,
2.146134,
2.145951,
2.145768,
2.145598,
2.145449,
2.145331,
2.14525,
2.14521,
2.145214,
2.145257,
2.145338,
2.14545,
2.145581,
2.145724,
2.145865,
2.145988,
2.146085,
2.146148,
2.14617,
2.146153,
2.146108,
2.146041,
2.145972,
2.145914,
2.145881,
2.145881,
2.145916,
2.14598,
2.146064,
2.146153,
2.146232,
2.146287,
2.14631,
2.146303,
2.146262,
2.146201,
2.146129,
2.146056,
2.145991,
2.145942,
2.145913,
2.145904,
2.145918,
2.145955,
2.146015,
2.146095,
2.146193,
2.146302,
2.146412,
2.146514,
2.146592,
2.146638,
2.146642,
2.146607,
2.14654,
2.146458,
2.14638,
2.146329,
2.146318,
2.146357,
2.14644,
2.146552,
2.146667,
2.146754,
2.146786,
2.146741,
2.146617,
2.146419,
2.146175,
2.145919,
2.145692,
2.145532,
2.145463,
2.145502,
2.14564,
2.145858,
2.146125,
2.146401,
2.146648,
2.146836,
2.146945,
2.14697,
2.146919,
2.146803,
2.146651,
2.146482,
2.146321,
2.146186,
2.146089,
2.146034,
2.146024,
2.146056,
2.146121,
2.146214,
2.146327,
2.146449,
2.14657,
2.14668,
2.146772,
2.146835,
2.146866,
2.146864,
2.146831,
2.146774,
2.1467,
2.146627,
2.146561,
2.146512,
2.146485,
2.146481,
2.146494,
2.146518,
2.146541,
2.146557,
2.146559,
2.146545,
2.146518,
2.146486,
2.146455,
2.146434,
2.146431,
2.146449,
2.14648,
2.14652,
2.146558,
2.146584,
2.146587,
2.146561,
2.146508,
2.146435,
2.146351,
2.146273,
2.146216,
2.146193,
2.146212,
2.146278,
2.146383,
2.146518,
2.146667,
2.146816,
2.146944,
2.147039,
2.147094,
2.147101,
2.147065,
2.146994,
2.146898,
2.146788,
2.146678,
2.14658,
2.146503,
2.146453,
2.146433,
2.146438,
2.146466,
2.146507,
2.146554,
2.146601,
2.146639,
2.146665,
2.146679,
2.146677,
2.146663,
2.146639,
2.146612,
2.146581,
2.14655,
2.146525,
2.146506,
2.146497,
2.146499,
2.146518,
2.146551,
2.146597,
2.146653,
2.146713,
2.14677,
2.146813,
2.146839,
2.146843,
2.146824,
2.14679,
2.146753,
2.146722,
2.146709,
2.146725,
2.14677,
2.146839,
2.146919,
2.146991,
2.147035,
2.147034,
2.146978,
2.146867,
2.146712,
2.146533,
2.146356,
2.146212,
2.146121,
2.146098,
2.146144,
2.146246,
2.146382,
2.146527,
2.146651,
2.146732,
2.146757,
2.146726,
2.14665,
2.146548,
2.146444,
2.146362,
2.146313,
2.146308,
2.146343,
2.14641,
2.146487,
2.146558,
2.146608,
2.146623,
2.146601,
2.146547,
2.146471,
2.146385,
2.146306,
2.146248,
2.146223,
2.146233,
2.14628,
2.14636,
2.146464,
2.14658,
2.146695,
2.146796,
2.146867,
2.146897,
2.146882,
2.146815,
2.146698,
2.146541,
2.14636,
2.146174,
2.146002,
2.145871,
2.145795,
2.145784,
2.145843,
2.145963,
2.14613,
2.146316,
2.146498,
2.14665,
2.146749,
2.146784,
2.146757,
2.146674,
2.146556,
2.146422,
2.146301,
2.146209,
2.146162,
2.146166,
2.146216,
2.146297,
2.146397,
2.146498,
2.146585,
2.146649,
2.146689,
2.146706,
2.146707,
2.1467,
2.146689,
2.146679,
2.146667,
2.146648,
2.146619,
2.146573,
2.146511,
2.146434,
2.146353,
2.146279,
2.146219,
2.146189,
2.14619,
2.146225,
2.146287,
2.146367,
2.146455,
2.146538,
2.146607,
2.146658,
2.146687,
2.146691,
2.146675,
2.146635,
2.146572,
2.146485,
2.146374,
2.146244,
2.146102,
2.145959,
2.145835,
2.145749,
2.145715,
2.145749,
2.145853,
2.146018,
2.146229,
2.146458,
2.146679,
2.146859,
2.146975,
2.147019,
2.146982,
2.146878,
2.146725,
2.146543,
2.146358,
2.14619,
2.14605,
2.145947,
2.145879,
2.14584,
2.145824,
2.145821,
2.145828,
2.145844,
2.145869,
2.145906,
2.145959,
2.146027,
2.14611,
2.146202,
2.146296,
2.146382,
2.146452,
2.146498,
2.146518,
2.146516,
2.146495,
2.146462,
2.14643,
2.146404,
2.146389,
2.146386,
2.146393,
2.1464,
2.1464,
2.146384,
2.146349,
2.146294,
2.146225,
2.146152,
2.146092,
2.146052,
2.146052,
2.146095,
2.146181,
2.146303,
2.146444,
2.146587,
2.14671,
2.146796,
2.146832,
2.146812,
2.146738,
2.14662,
2.146475,
2.146319,
2.146168,
2.146039,
2.145944,
2.145889,
2.145878,
2.145906,
2.145967,
2.146054,
2.146154,
2.146256,
2.14635,
2.14642,
2.146463,
2.146476,
2.14646,
2.146421,
2.146373,
2.146328,
2.146299,
2.146297,
2.146323,
2.146372,
2.14643,
2.14648,
2.146503,
2.14648,
2.146405,
2.14628,
2.14612,
2.145947,
2.145793,
2.14569,
2.145661,
2.145716,
2.145856,
2.146067,
2.146315,
2.146569,
2.146795,
2.146962,
2.147053,
2.147061,
2.146995,
2.146874,
2.146723,
2.146565,
2.146425,
2.146315,
2.146242,
2.146205,
2.146196,
2.146203,
2.146216,
2.146225,
2.146227,
2.146221,
2.14621,
2.146203,
2.146204,
2.146218,
2.146247,
2.146292,
2.146341,
2.146388,
2.146422,
2.146433,
2.146412,
2.146358,
2.14627,
2.146158,
2.146034,
2.145911,
2.145809,
2.145738,
2.145705,
2.145715,
2.145763,
2.145838,
2.145926,
2.146014,
2.146089,
2.146141,
2.146169,
2.146176,
2.146166,
2.146148,
2.146129,
2.146118,
2.146113,
2.146118,
2.146128,
2.146139,
2.146144,
2.14614,
2.146128,
2.146105,
2.146077,
2.146048,
2.146018,
2.14599,
2.145966,
2.145946,
2.145929,
2.145911,
2.145894,
2.145876,
2.145857,
2.145839,
2.145824,
2.145812,
2.145804,
2.145801,
2.145804,
2.145811,
2.145819,
2.145828,
2.145837,
2.145843,
2.145845,
2.145841,
2.145833,
2.145821,
2.145809,
2.145797,
2.145787,
2.145783,
2.145781,
2.145784,
2.145781,
2.145769,
2.145744,
2.145694,
2.145618,
2.145521,
2.145406,
2.145282,
2.145162,
2.145064,
2.144993,
2.144965,
2.14498,
2.145039,
2.145133,
2.145251,
2.145385,
2.145524,
2.145658,
2.14578,
2.14589,
2.145981,
2.146054,
2.146103,
2.146127,
2.146119,
2.146076,
2.146,
2.145895,
2.145771,
2.145635,
2.14551,
2.145409,
2.145343,
2.145324,
2.145353,
2.145421,
2.145519,
2.145634,
2.145752,
2.145857,
2.145945,
2.146012,
2.146056,
2.146081,
2.146094,
2.146091,
2.146073,
2.146037,
2.145982,
2.145895,
2.145776,
2.145625,
2.145445,
2.145248,
2.145047,
2.144861,
2.144708,
2.144608,
2.144576,
2.144621,
2.144747,
2.144949,
2.145214,
2.145524,
2.14585,
2.146166,
2.146438,
2.14664,
2.146752,
2.146765,
2.146681,
2.146517,
2.146299,
2.146062,
2.145841,
2.14567,
2.145572,
2.145557,
2.145621,
2.145746,
2.145906,
2.146071,
2.14621,
2.146301,
2.146336,
2.146313,
2.146247,
2.146159,
2.146071,
2.146006,
2.145979,
2.145994,
2.146053,
2.146137,
2.146232,
2.14632,
2.146383,
2.14641,
2.146398,
2.146355,
2.146286,
2.146213,
2.146149,
2.146108,
2.146101,
2.146128,
2.146187,
2.146264,
2.146343,
2.14641,
2.14645,
2.146453,
2.14642,
2.146355,
2.146272,
2.146191,
2.14613,
2.146108,
2.146135,
2.146214,
2.146339,
2.146498,
2.14667,
2.146832,
2.146968,
2.147063,
2.147108,
2.147107,
2.147066,
2.146996,
2.14691,
2.146817,
2.146731,
2.146648,
2.146575,
2.146511,
2.146454,
2.146404,
2.146365,
2.14634,
2.146334,
2.146351,
2.146394,
2.146459,
2.146542,
2.146631,
2.146716,
2.146786,
2.14683,
2.146838,
2.14681,
2.146747,
2.146653,
2.14654,
2.146418,
2.146301,
2.146203,
2.146139,
2.146117,
2.146144,
2.14622,
2.146341,
2.146495,
2.146666,
2.146834,
2.146982,
2.147093,
2.147155,
2.147168,
2.147134,
2.147067,
2.146986,
2.146909,
2.146853,
2.146833,
2.146855,
2.146914,
2.147004,
2.147109,
2.147213,
2.147295,
2.147345,
2.147352,
2.147309,
2.147219,
2.14709,
2.146932,
2.146761,
2.146594,
2.146452,
2.14635,
2.146304,
2.146321,
2.146402,
2.146537,
2.146711,
2.146899,
2.147075,
2.14721,
2.147284,
2.147286,
2.147217,
2.147092,
2.146933,
2.146772,
2.146639,
2.146559,
2.146547,
2.146608,
2.146731,
2.146895,
2.147077,
2.147246,
2.147381,
2.147466,
2.147495,
2.147472,
2.147407,
2.14731,
2.147198,
2.147082,
2.146971,
2.146872,
2.146785,
2.146714,
2.146661,
2.14663,
2.146622,
2.146639,
2.146684,
2.146751,
2.146838,
2.146932,
2.147023,
2.147099,
2.147151,
2.147173,
2.147165,
2.147127,
2.147068,
2.146997,
2.146921,
2.146849,
2.146784,
2.146723,
2.146666,
2.14661,
2.146553,
2.146501,
2.146457,
2.146428,
2.146428,
2.146465,
2.146547,
2.146672,
2.146837,
2.147024,
2.147215,
2.147383,
2.147508,
2.147571,
2.147562,
2.147483,
2.147345,
2.14717,
2.146984,
2.146816,
2.14669,
2.14662,
2.14661,
2.146654,
2.146738,
2.146834,
2.146925,
2.146989,
2.147015,
2.147005,
2.146966,
2.146915,
2.146868,
2.146847,
2.146862,
2.146913,
2.146996,
2.147097,
2.147195,
2.147273,
2.147319,
2.147323,
2.147291,
2.147233,
2.147167,
2.147109,
2.147075,
2.147074,
2.147105,
2.147159,
2.147224,
2.147277,
2.147304,
2.147292,
2.147242,
2.147158,
2.14706,
2.146969,
2.146908,
2.1469,
2.146957,
2.147081,
2.14726,
2.147475,
2.147695,
2.147889,
2.148031,
2.148102,
2.14809,
2.148002,
2.147855,
2.147675,
2.147491,
2.147332,
2.147225,
2.14718,
2.147202,
2.147281,
2.147401,
2.14754,
2.147674,
2.147781,
2.147846,
2.147861,
2.147828,
2.147752,
2.147645,
2.147526,
2.147407,
2.147303,
2.147224,
2.14718,
2.147169,
2.14719,
2.147239,
2.147306,
2.147385,
2.147465,
2.147542,
2.147613,
2.147674,
2.147726,
2.147772,
2.147811,
2.147843,
2.147865,
2.147869,
2.147845,
2.147788,
2.14769,
2.14755,
2.147375,
2.147179,
2.14698,
2.146806,
2.14668,
2.14662,
2.14664,
2.146735,
2.146894,
2.147093,
2.1473,
2.147483,
2.147617,
2.147683,
2.147677,
2.147608,
2.147494,
2.147364,
2.147244,
2.147156,
2.147117,
2.147126,
2.147182,
2.147265,
2.14736,
2.147449,
2.147518,
2.147562,
2.147588,
2.147604,
2.147622,
2.147658,
2.147722,
2.147808,
2.147916,
2.14803,
2.148133,
2.148206,
2.148233,
2.148207,
2.14813,
2.148011,
2.147865,
2.147715,
2.14758,
2.147476,
2.147417,
2.147406,
2.147441,
2.147511,
2.147606,
2.147713,
2.147819,
2.147914,
2.147995,
2.148058,
2.1481,
2.148124,
2.148129,
2.148118,
2.14809,
2.148051,
2.148,
2.147944,
2.147889,
2.147844,
2.147816,
2.14781,
2.147829,
2.147874,
2.147937,
2.148011,
2.148084,
2.148142,
2.148176,
2.148181,
2.148154,
2.148099,
2.148023,
2.147941,
2.147863,
2.147805,
2.147776,
2.14778,
2.147822,
2.147895,
2.147996,
2.148115,
2.148237,
2.148356,
2.148463,
2.148553,
2.14862,
2.148663,
2.148683,
2.148681];

line2 = [1.156409,
1.156355,
1.156317,
1.156314,
1.156354,
1.156438,
1.156551,
1.156679,
1.1568,
1.15689,
1.156942,
1.156948,
1.156918,
1.156861,
1.156802,
1.156758,
1.156747,
1.156776,
1.156844,
1.156941,
1.157048,
1.157142,
1.157207,
1.157225,
1.157189,
1.157102,
1.156977,
1.156831,
1.156687,
1.156567,
1.156492,
1.156471,
1.156507,
1.156596,
1.156722,
1.156864,
1.157002,
1.157111,
1.157174,
1.15718,
1.157126,
1.157021,
1.156877,
1.156711,
1.156549,
1.156407,
1.156302,
1.156242,
1.156227,
1.156252,
1.1563,
1.156361,
1.156417,
1.15646,
1.156481,
1.156485,
1.156478,
1.156469,
1.156471,
1.156495,
1.156543,
1.156615,
1.156707,
1.156804,
1.156893,
1.156962,
1.157002,
1.157007,
1.156978,
1.156921,
1.156846,
1.156767,
1.156696,
1.156641,
1.156609,
1.1566,
1.156612,
1.156645,
1.156694,
1.156757,
1.156834,
1.156921,
1.15702,
1.157128,
1.15724,
1.157349,
1.157442,
1.157502,
1.157522,
1.157484,
1.157386,
1.157227,
1.15702,
1.156781,
1.156536,
1.156317,
1.156143,
1.156043,
1.156024,
1.156087,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156221,
1.156458,
1.156287,
1.156102,
1.15592,
1.15576,
1.15564,
1.155578,
1.15558,
1.155645,
1.15576,
1.155907,
1.156059,
1.156195,
1.156292,
1.156337,
1.156332,
1.156281,
1.156203,
1.156116,
1.156041,
1.155992,
1.155977,
1.156002,
1.156055,
1.15613,
1.156217,
1.156305,
1.156388,
1.156466,
1.156539,
1.156608,
1.156673,
1.156732,
1.156776,
1.156798,
1.156789,
1.156746,
1.156667,
1.156563,
1.156445,
1.156335,
1.156254,
1.156218,
1.156234,
1.156306,
1.156423,
1.156568,
1.156721,
1.156856,
1.15696,
1.15702,
1.157036,
1.157013,
1.15696,
1.156891,
1.156821,
1.156754,
1.156695,
1.156644,
1.156598,
1.156551,
1.156505,
1.156458,
1.156417,
1.156389,
1.156382,
1.1564,
1.156446,
1.156514,
1.156599,
1.156689,
1.15677,
1.156831,
1.156864,
1.156866,
1.156837,
1.156782,
1.156712,
1.156632,
1.156555,
1.156488,
1.156434,
1.156399,
1.156383,
1.156384,
1.156398,
1.156423,
1.156457,
1.156491,
1.156522,
1.156547,
1.156564,
1.156571,
1.156569,
1.156559,
1.156543,
1.156522,
1.156495,
1.156461,
1.156414,
1.156347,
1.156259,
1.15615,
1.156024,
1.155892,
1.155771,
1.15568,
1.155642,
1.155671,
1.155773,
1.155944,
1.156167,
1.15641,
1.15664,
1.15682,
1.156914,
1.156908,
1.156799,
1.1566,
1.156346,
1.156078,
1.155838,
1.15567,
1.155598,
1.155632,
1.155761,
1.15596,
1.15619,
1.156413,
1.15659,
1.156697,
1.156725,
1.156683,
1.156591,
1.156479,
1.156382,
1.156324,
1.156317,
1.156365,
1.156452,
1.156554,
1.156644,
1.156695,
1.15669,
1.156619,
1.156494,
1.156334,
1.156168,
1.156026,
1.155936,
1.155915,
1.155965,
1.156078,
1.156232,
1.156396,
1.156539,
1.156631,
1.156654,
1.1566,
1.156476,
1.156296,
1.156089,
1.155883,
1.155705,
1.155584,
1.155532,
1.155558,
1.155655,
1.155813,
1.156007,
1.156216,
1.156413,
1.156576,
1.156687,
1.156735,
1.156721,
1.156651,
1.15654,
1.156408,
1.156277,
1.156167,
1.156094,
1.156068,
1.156088,
1.156143,
1.156219,
1.156298,
1.156358,
1.156387,
1.156373,
1.156319,
1.156233,
1.15613,
1.156031,
1.155956,
1.155918,
1.15592,
1.15596,
1.156025,
1.156092,
1.156141,
1.15615,
1.156105,
1.156002,
1.15585,
1.155663,
1.155465,
1.155282,
1.155136,
1.155045,
1.155017,
1.155052,
1.155139,
1.155261,
1.155401,
1.155541,
1.155667,
1.155768,
1.155843,
1.15589,
1.155914,
1.155918,
1.155906,
1.155879,
1.155838,
1.155781,
1.15571,
1.155626,
1.155533,
1.155435,
1.155342,
1.155262,
1.155202,
1.155171,
1.155173,
1.155209,
1.155277,
1.155374,
1.155492,
1.155625,
1.155764,
1.1559,
1.156023,
1.156126,
1.156201,
1.156245,
1.156254,
1.156228,
1.156174,
1.156099,
1.156011,
1.155923,
1.155844,
1.155782,
1.155739,
1.15572,
1.155719,
1.155724,
1.155733,
1.15573,
1.155714,
1.155679,
1.155624,
1.155556,
1.155482,
1.155407,
1.15534,
1.155285,
1.155239,
1.155204,
1.155173,
1.155143,
1.155109,
1.155073,
1.155039,
1.155008,
1.154997,
1.15501,
1.155053,
1.155126,
1.155225,
1.15534,
1.155454,
1.15555,
1.155614,
1.155633,
1.155596,
1.155512,
1.155388,
1.155237,
1.155077,
1.154927,
1.154801,
1.154712,
1.154665,
1.154659,
1.154691,
1.154749,
1.154829,
1.154922,
1.155017,
1.155109,
1.155193,
1.15526,
1.155308,
1.155331,
1.155326,
1.155292,
1.155229,
1.155145,
1.155045,
1.154945,
1.154855,
1.15479,
1.154761,
1.154776,
1.154836,
1.154939,
1.155074,
1.155228,
1.155385,
1.155532,
1.155653,
1.155738,
1.155784,
1.155792,
1.155764,
1.155713,
1.155649,
1.155585,
1.155533,
1.155501,
1.155495,
1.155517,
1.15556,
1.155622,
1.155689,
1.155756,
1.155811,
1.155852,
1.155877,
1.15589,
1.155902,
1.15592,
1.155957,
1.156022,
1.156116,
1.156241,
1.156393,
1.156558,
1.156727,
1.156882,
1.157017,
1.157121,
1.157191,
1.157233,
1.157249,
1.15725,
1.157243,
1.157235,
1.157232,
1.157236,
1.157241,
1.157248,
1.157252,
1.15725,
1.157242,
1.15723,
1.15722,
1.157217,
1.157229,
1.157261,
1.157315,
1.157392,
1.157483,
1.157582,
1.157674,
1.157746,
1.157788,
1.157788,
1.157744,
1.157661,
1.157545,
1.157412,
1.157282,
1.15717,
1.157098,
1.157076,
1.157112,
1.157206,
1.157348,
1.157528,
1.157726,
1.157925,
1.158105,
1.15825,
1.158348,
1.158392,
1.158384,
1.158326,
1.158226,
1.158092,
1.157939,
1.15778,
1.157625,
1.157483,
1.157367,
1.157279,
1.157222,
1.157202,
1.157211,
1.157249,
1.157311,
1.157388,
1.157477,
1.157572,
1.157664,
1.157749,
1.157821,
1.157872,
1.157897,
1.157892,
1.157854,
1.157782,
1.157683,
1.157564,
1.157445,
1.157335,
1.157258,
1.157228,
1.157258,
1.157349,
1.157498,
1.157686,
1.157891,
1.158081,
1.158227,
1.158307,
1.158301,
1.158209,
1.158045,
1.157831,
1.157602,
1.157395,
1.157245,
1.157177,
1.157201,
1.157317,
1.157501,
1.157728,
1.157956,
1.158153,
1.158286,
1.158338,
1.158311,
1.158212,
1.158067,
1.157906,
1.157758,
1.157652,
1.157604,
1.157613,
1.157673,
1.157759,
1.157845,
1.157906,
1.157916,
1.157862,
1.157748,
1.157585,
1.157398,
1.157215,
1.157067,
1.156977,
1.156959,
1.157011,
1.157123,
1.157269,
1.157421,
1.157554,
1.157639,
1.15767,
1.157642,
1.157568,
1.157464,
1.157353,
1.157252,
1.157177,
1.157129,
1.157103,
1.157089,
1.157071,
1.157037,
1.156983,
1.156912,
1.156835,
1.156771,
1.156739,
1.156757,
1.156832,
1.156961,
1.15713,
1.157313,
1.157481,
1.157605,
1.157663,
1.157644,
1.15755,
1.157403,
1.157228,
1.15706,
1.15693,
1.156863,
1.156871,
1.156954,
1.157095,
1.15727,
1.157447,
1.157596,
1.157693,
1.157724,
1.157686,
1.157587,
1.157447,
1.157288,
1.157136,
1.157011,
1.15693,
1.156901,
1.156921,
1.156985,
1.157081,
1.157196,
1.157314,
1.157424,
1.157517,
1.157583,
1.157619,
1.157628,
1.157607,
1.157564,
1.157505,
1.157438,
1.157373,
1.157323,
1.157294,
1.157294,
1.157324,
1.15738,
1.157456,
1.15754,
1.157615,
1.157669,
1.15769,
1.157672,
1.157614,
1.157525,
1.157419,
1.157312,
1.157222,
1.157163,
1.157147,
1.157175,
1.157244,
1.157344,
1.157459,
1.157571,
1.15767,
1.157743,
1.157783,
1.157795,
1.157783,
1.157756,
1.157723,
1.157691,
1.157669,
1.157651,
1.157635,
1.157612,
1.157574,
1.157516,
1.157432,
1.15733,
1.157216,
1.157105,
1.157015,
1.15696,
1.156951,
1.156991,
1.157072,
1.157185,
1.157305,
1.157411,
1.157485,
1.157512,
1.157489,
1.157428,
1.157344,
1.15726,
1.1572,
1.157183,
1.157218,
1.157305,
1.15743,
1.15757,
1.157701,
1.157799,
1.157849,
1.157844,
1.157788,
1.157701,
1.157598,
1.157504,
1.157436,
1.157403,
1.157405,
1.157433,
1.157473,
1.157507,
1.157524,
1.157515,
1.157483,
1.157438,
1.15739,
1.157356,
1.157342,
1.157358,
1.157397,
1.157443,
1.157487,
1.157508,
1.157493,
1.157437,
1.157345,
1.157229,
1.157106,
1.156998,
1.156922,
1.156896,
1.156914,
1.156973,
1.157054,
1.157135,
1.157195,
1.157221,
1.157204,
1.157145,
1.157062,
1.156976,
1.156906,
1.156876,
1.156892,
1.156959,
1.157065,
1.157187,
1.157301,
1.157377,
1.157393,
1.157341,
1.157222,
1.157051,
1.156853,
1.15666,
1.156502,
1.156406,
1.156383,
1.156437,
1.156556,
1.156719,
1.156901,
1.157077,
1.157221,
1.157321,
1.157372,
1.157379,
1.15735,
1.157304,
1.157256,
1.157216,
1.157192,
1.157185,
1.15719,
1.157199,
1.157202,
1.157194,
1.15717,
1.157132,
1.157085,
1.157039,
1.157004,
1.156984,
1.156988,
1.157017,
1.157063,
1.157125,
1.157185];

% line2 = 0-line2;
l1 = size(line1);
n = res:res:l1*res;

% line1 = movmean(line1,50);
% line2 = movmean(line2,50);
figure(1)
plot(n,line1)
hold on
plot(n,line2)

tmin = 10;
tmax = 40;

NumLags = 10;
NumLags = 100;
%[c,lags] = crosscorr(line2, line1,NumLags);
[c,lags] = crosscorr(line1, line2, NumLags);
% [c,lags] = xcorr(line1, line2,4000);
lags = lags*res;
% lags2 = lags2*res;

figure(2)
plot(lags,c)


% figure(3)
% plot(lags2,c2)

sws = max(c); %cross correlation coefficient
highr = sws


[maximum, index] = max(c);

max_x = lags(index); %time delay
highshift = max_x

% figure(3)
% plot(n(tmin/res:tmax/res),dz1(tmin/res:tmax/res))
% hold on
% plot(n(tmin/res:tmax/res),dz2(tmin/res:tmax/res))
% 
% TT = table(n',dz1,dz2);
% %TT = table(lags',c);
% writetable(TT, 'test.txt')